imports:
- path: project.py

resources:
# The "name" property below will be the name of the new project
# needs to be between 4 to 30 characters
- name: $$XX-test-gitlabci-k8s-1$$
  type: project.py
  properties:
    # Change this to your organization ID.
    organization-id: "$$YOUR_DATA$$"
    # Change the following to your organization's billing account
    billing-account-name: billingAccounts/$$YOUR_DATA$$
    # The apis to enable in the new project.
    # To see the possible APIs, use gcloud CLI: gcloud service-management list
    apis:
    - compute-component.googleapis.com
    - deploymentmanager.googleapis.com
    - container.googleapis.com
    - storage-component.googleapis.com
    - monitoring.googleapis.com
    - logging.googleapis.com
    # The service accounts you want to create in the project
    service-accounts:
    - gitlab-ci-token
    # IAM policy on the new project
    iam-policy:
      bindings:
      - role: roles/owner
        members:
        # Make sure to include the DM service account that is doing the deployment!
        - serviceAccount:$$YOUR_DATA$$@cloudservices.gserviceaccount.com
        # Add any others you want to have access
        - user:$$YOUR_DATA$$
      - role: roles/container.developer
        members:
        - serviceAccount:gitlab-ci-token@$$XX-test-gitlabci-k8s-1$$.iam.gserviceaccount.com
      - role: roles/storage.admin
        members:
        - serviceAccount:gitlab-ci-token@$$XX-test-gitlabci-k8s-1$$.iam.gserviceaccount.com
      - role: roles/storage.objectCreator
        members:
        - serviceAccount:gitlab-ci-token@$$XX-test-gitlabci-k8s-1$$.iam.gserviceaccount.com
      - role: roles/storage.objectViewer
        members:
        - serviceAccount:gitlab-ci-token@$$XX-test-gitlabci-k8s-1$$.iam.gserviceaccount.com
